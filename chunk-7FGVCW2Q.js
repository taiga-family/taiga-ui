import{Ca as C,R as k,V as l,ma as w,u as M}from"./chunk-DQUJKZWW.js";import{a as H,f as L,g as _,m as D}from"./chunk-R5FWCOT5.js";import{$a as x,E as a,Gb as R,J as b,S as A,Ta as I,Vb as N,Wa as g,Wc as U,_a as S,ha as E,oa as F,w as v,wa as O,za as c}from"./chunk-YCEEMOGF.js";var n=class{constructor(s,e){this.el=s;this.options=e}get element(){return(this.el.nativeElement.tagName.includes("-")?this.el.nativeElement.querySelector(this.options.query):this.el.nativeElement)||this.el.nativeElement}get isTextFieldElement(){return this.element.matches(this.options.query)}};var B=1e3,Z=".ng-animating",m=class extends n{constructor(e,t,o,r){super(e,r);this.animationFrame$=t;this.zone=o}setFocus(){this.isTextFieldElement?b(a(this.options.delay||B),this.animationFrame$.pipe(F(100,w(this.zone)),v(()=>this.element.closest(Z)),E(Boolean),A(1))).subscribe(()=>this.element.focus({preventScroll:this.options.preventScroll})):this.element.focus({preventScroll:!0})}};var z=["type","inputMode","autocomplete","accept","min","max","step","pattern","size","maxlength"],d=class extends n{constructor(e,t,o,r,i){super(e,i);this.renderer=t;this.zone=o;this.win=r}setFocus(){this.isTextFieldElement?this.zone.runOutsideAngular(()=>this.iosWebkitAutofocus()):this.element.focus({preventScroll:!0})}iosWebkitAutofocus(){var T;let e=this.makeFakeInput(),t=this.getDurationTimeBeforeFocus(),o=0,r=0,i=()=>e.focus({preventScroll:!0}),h=()=>{clearTimeout(o),o=this.win.setTimeout(()=>{clearTimeout(r),e.removeEventListener("blur",i),e.removeEventListener("focus",h),r=this.win.setTimeout(()=>{this.element.focus({preventScroll:this.options.preventScroll}),e.remove()},t)})};e.addEventListener("blur",i,{once:!0}),e.addEventListener("focus",h),this.insideDialog()?this.win.document.body.appendChild(e):(T=this.element.parentElement)==null||T.appendChild(e),e.focus({preventScroll:!0})}makeFakeInput(){let e=this.renderer.createElement("input"),t=this.element.getBoundingClientRect();return this.patchFakeInputFromFocusableElement(e),e.style.height=l(t.height),e.style.width=l(t.width/2),e.style.position="fixed",e.style.zIndex="-99999999",e.style.caretColor="transparent",e.style.border="none",e.style.outline="none",e.style.color="transparent",e.style.background="transparent",e.style.cursor="none",e.style.fontSize=l(16),e.style.top=l(t.top),e.style.left=l(t.left),e}getDurationTimeBeforeFocus(){return parseFloat(this.win.getComputedStyle(this.element).getPropertyValue("--tui-duration"))||0}insideDialog(){return!!this.element.closest("tui-dialog")}patchFakeInputFromFocusableElement(e){z.forEach(t=>{let o=this.element.getAttribute(t);k(o)&&e.setAttribute(t,o)})}};var[f,ie]=M({delay:NaN,query:"input, textarea, select, [contenteditable]",preventScroll:!1}),y=new O(""),P=[{provide:y,deps:[x,_,R,g,L,D,f],useFactory:(p,s,e,t,o,r,i)=>r?new d(p,e,t,o,i):new m(p,s,t,i)}];var u=class u{constructor(){this.handler=c(y);this.options=c(f);this.destroyRef=c(I);this.autoFocus=S(void 0,{alias:"tuiAutoFocus",transform:C})}ngAfterViewInit(){this.autoFocus()&&this.focus()}focus(){Number.isNaN(this.options.delay)?Promise.resolve().then(()=>this.handler.setFocus()):a(this.options.delay).pipe(H(this.destroyRef)).subscribe(()=>this.handler.setFocus())}};u.\u0275fac=function(e){return new(e||u)},u.\u0275dir=N({type:u,selectors:[["","tuiAutoFocus",""]],inputs:{autoFocus:[1,"tuiAutoFocus","autoFocus"]},features:[U(P)]});var W=u;export{ie as a,W as b};
