<tui-wrapper
    class="t-wrapper"
    [appearance]="appearance"
    [readOnly]="readOnly"
    [disabled]="disabled"
    [focused]="computedFocused"
    [hovered]="computedHovered"
    [invalid]="computedInvalid"
    (tuiActiveZoneChange)="onActiveZone($event)"
>
    <tui-input-number
        tuiTextfieldNoneAppearance
        class="t-text-input"
        [min]="min"
        [max]="value[1]"
        [precision]="precision"
        [decimal]="decimal"
        [postfix]="(minLabel || leftValueContent) && showLeftValueContent ? '' : value[0] | i18nPlural: pluralizeMap || pluralizeMapFallback"
        [disabled]="computedDisabled"
        [readOnly]="readOnly"
        [tuiTextfieldSize]="computedSize"
        [tuiTextfieldLabelOutside]="legacyLabelOutside"
        [ngModel]="value[0]"
        (ngModelChange)="onInputLeft($event)"
        (focusedChange)="onTextInputFocused($event, false)"
        (keydown.arrowUp)="incrementByStep($event, false)"
        (keydown.arrowDown)="decrementByStep($event, false)"
    >
        <ng-content></ng-content>
        <div
            *ngIf="(minLabel || leftValueContent) && showLeftValueContent"
            polymorpheus-outlet
            [content]="minLabel ? legacyMinLabel : leftValueContent"
            [context]="{$implicit: value[0]}"
        ></div>
    </tui-input-number>

    <tui-input-number
        tuiTextfieldNoneAppearance
        class="t-text-input"
        [min]="value[0]"
        [max]="max"
        [precision]="precision"
        [decimal]="decimal"
        [disabled]="computedDisabled"
        [readOnly]="readOnly"
        [tuiTextfieldSize]="computedSize"
        [tuiTextfieldLabelOutside]="legacyLabelOutside"
        [ngModel]="value[1]"
        (ngModelChange)="onInputRight($event)"
        (focusedChange)="onTextInputFocused($event, true)"
        (keydown.arrowUp)="incrementByStep($event, true)"
        (keydown.arrowDown)="decrementByStep($event, true)"
    >
        <div
            *ngIf="(maxLabel || rightValueContent) && showRightValueContent"
            polymorpheus-outlet
            [content]="maxLabel ? legacyMaxLabel : rightValueContent"
            [context]="{$implicit: value[1]}"
        ></div>
    </tui-input-number>

    <!-- TODO replace by postfix of the right InputNumber (after fix https://github.com/Tinkoff/taiga-ui/issues/1193) -->
    <span
        *ngIf="!((maxLabel || rightValueContent) && showRightValueContent) && pluralizeMap"
        automation-id="tui-input-range__pluralize-right"
        class="t-pluralize-right"
    >
        &nbsp;{{value[1] | i18nPlural: pluralizeMap || pluralizeMapFallback}}
    </span>

    <tui-range
        class="t-slider"
        [min]="min"
        [max]="max"
        [steps]="computedSteps"
        [segments]="segments"
        [keySteps]="keySteps"
        [pluralize]="segmentsPluralizeMap"
        [focusable]="false"
        [disabled]="readOnly || disabled"
        [ngModel]="value"
        (ngModelChange)="onRangeValue($event)"
        (tuiPressedChange)="focusToTextInput()"
    ></tui-range>
</tui-wrapper>

<!-- TODO remove in v3.0 -->
<ng-template
    #legacyMinLabel
    let-value
>
    <ng-container *ngIf="value === min">{{minLabel}}</ng-container>
    <ng-container *ngIf="value !== min">
        {{value}}&nbsp;{{value | i18nPlural: pluralizeMap ||
        pluralizeMapFallback}}
    </ng-container>
</ng-template>

<!-- TODO remove in v3.0 -->
<ng-template
    #legacyMaxLabel
    let-value
>
    <ng-container *ngIf="value === max">{{maxLabel}}</ng-container>
    <ng-container *ngIf="value !== max">
        {{value}}&nbsp;{{value | i18nPlural: pluralizeMap ||
        pluralizeMapFallback}}
    </ng-container>
</ng-template>
