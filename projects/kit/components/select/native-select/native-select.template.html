@if (showPlaceholder()) {
    <option
        disabled
        selected
        value=""
    >
        {{ placeholder() }}
    </option>
}

@if (items && !isFlat(items)) {
    @for (group of labels; track group) {
        <optgroup [label]="labels[$index]">
            <ng-container *ngTemplateOutlet="options; context: {$implicit: items[$index]}" />
        </optgroup>
    }
} @else {
    <ng-container *ngTemplateOutlet="options; context: {$implicit: items}" />
}

<ng-template
    #options
    let-items
>
    @for (option of items; track option) {
        <option
            [disabled]="itemsHandlers.disabledItemHandler()(option)"
            [selected]="isSelected()(option)"
            [value]="itemsHandlers.stringify()(option)"
        >
            {{ itemsHandlers.stringify()(option) }}
        </option>
    }
</ng-template>
