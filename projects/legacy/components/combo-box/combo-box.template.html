<div
    tuiDropdownOpenMonitor
    class="t-hosted"
    [tuiDropdown]="datalist || ''"
    [tuiDropdownEnabled]="interactive && !!datalist"
    [(tuiDropdownOpen)]="open"
    (tuiActiveZoneChange)="onActiveZone($event)"
>
    <tui-primitive-textfield
        automation-id="tui-combo-box__textfield"
        class="t-textfield"
        [disabled]="computedDisabled"
        [focusable]="computedFocusable"
        [invalid]="computedInvalid"
        [nativeId]="nativeId"
        [pseudoFocus]="computedFocused"
        [pseudoHover]="pseudoHover"
        [readOnly]="readOnly"
        [tuiTextfieldIcon]="arrow ? icon : ''"
        [value]="nativeValue"
        (click)="toggle()"
        (keydown.enter)="onFieldKeyDownEnter($event)"
        (valueChange)="onValueChange($event)"
    >
        <ng-content />
        <ng-content
            ngProjectAs="input"
            select="input"
        />
        @if (showValueTemplate) {
            <div
                automation-id="tui-combo-box__template"
                ngProjectAs="tuiContent"
                class="t-value"
            >
                <ng-container
                    *polymorpheusOutlet="computedContent as text; context: {$implicit: value!, active: computedFocused}"
                >
                    {{ text }}
                </ng-container>
            </div>
        }
    </tui-primitive-textfield>

    <ng-template #icon>
        <div
            appearance="icon"
            tuiWrapper
            class="t-icon"
        >
            <ng-container *polymorpheusOutlet="arrow" />
        </div>
    </ng-template>
</div>
