<form [formGroup]="testForm">
    @for (phone of formData.controls; track phone; let i = $index) {
        <label
            formArrayName="phones"
            tuiLabel
            class="tui-space_bottom-4"
        >
            Phone number {{ i + 1 }}
            <span class="row">
                <tui-input-phone
                    tuiTextfieldSize="m"
                    class="input"
                    [formControlName]="i"
                    [tuiTextfieldLabelOutside]="true"
                >
                    <input
                        autocomplete="new-password"
                        tuiTextfieldLegacy
                    />
                </tui-input-phone>
                <button
                    appearance="icon"
                    iconStart="@tui.trash"
                    size="m"
                    tuiIconButton
                    type="button"
                    class="tui-space_left-2 icon"
                    (click)="removePhone(i)"
                >
                    Delete phone number
                </button>
            </span>
            <ng-template #phoneErrorContent>Invalid phone number length</ng-template>
            <tui-error
                [error]="[] | tuiFieldError | async"
                [formControlName]="i"
            />
        </label>
    }

    <tui-error
        formArrayName="phones"
        class="form-array-error"
        [error]="[] | tuiFieldError | async"
    />

    <button
        size="s"
        tuiButton
        type="button"
        class="tui-space_top-4"
        (click)="addPhone()"
    >
        Add a phone number
    </button>
</form>
