<tui-tree
    *ngFor="let item of data.children"
    [childrenHandler]="handler"
    [content]="content"
    [tuiTreeController]="true"
    [value]="item"
/>

<ng-template
    #content
    let-treeItem="node"
    let-treeNode
>
    <label
        tuiLabel
        class="tui-space_vertical-2 tui-space_left-1"
    >
        <input
            size="s"
            tuiCheckbox
            type="checkbox"
            [ngModel]="treeNode | tuiMapper: getValue : map"
            (ngModelChange)="onChecked(treeNode, treeItem, $event)"
        />
        <small>{{ treeNode.text }}</small>
    </label>

    <button
        appearance="flat"
        iconStart="@tui.circle-plus"
        size="xs"
        tuiIconButton
        type="button"
        (click)="add(treeNode, treeItem)"
    >
        Add new item
    </button>
</ng-template>
