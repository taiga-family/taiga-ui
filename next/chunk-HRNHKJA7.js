import{Na as K,a as $,hb as W,na as u,o as h,va as H,ya as G}from"./chunk-HYGHFAUK.js";import{d as b,e as B,g as j,m as Y}from"./chunk-A2R73ZSN.js";import{Bc as S,G as w,I as E,Ka as R,U as f,V as L,Wb as r,Xc as T,_a as m,bb as y,d as C,i as D,ia as g,j as O,ja as v,nd as U,p as N,s as P,sd as M,td as s,w as k,za as i}from"./chunk-MAQQ6KKR.js";var d=class d{};d.\u0275fac=function(e){return new(e||d)},d.\u0275dir=r({type:d,selectors:[["","tuiItem",""]]});var Z=d;var o=class o{constructor(){this.onChange=h;this.validate=B.nullValidator}registerOnValidatorChange(t){this.onChange=t}ngOnChanges(){this.onChange()}};o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=r({type:o,selectors:[["","tuiValidator",""]],inputs:{validate:[0,"tuiValidator","validate"]},features:[T([u(b,o,!0)]),R]});var _=o;var c=class{};function ut(a){return{provide:c,useFactory:()=>i(a).valueTransformer}}var q=class extends c{fromControlValue(t){return this.prevValue=t,t}toControlValue(t){return this.prevValue=t??this.prevValue,this.prevValue}},z={fromControlValue:C,toControlValue:C};var J=class{constructor(t,e={}){this.message=t;this.context=e}};var n=class n{constructor(){this.el=K();this.control$=new O(null);this.sub=this.control$.pipe(v(t=>(t==null?void 0:t.events)||P(null)),f(0),G(),H()).subscribe(()=>this.handleValidation());this.tuiNativeValidator=m("Invalid")}validate(t){return this.control$.next(t),null}handleValidation(){var e,l,V,A,I;let t=!!((e=this.control$.value)!=null&&e.touched)&&((l=this.control$.value)==null?void 0:l.invalid);(V=this.el.closest("tui-textfield"))==null||V.classList.toggle("tui-invalid",t),(I=(A=this.el).setCustomValidity)==null||I.call(A,t?this.tuiNativeValidator():"")}};n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=r({type:n,selectors:[["","tuiNativeValidator",""]],hostBindings:function(e,l){e&1&&S("focusout",function(){return l.handleValidation()})},inputs:{tuiNativeValidator:[1,"tuiNativeValidator"]},features:[T([u(b,n,!0)])]});var Q=n;var X={self:!0,optional:!0},p=class p{constructor(){this.fallback=i(W,X);this.refresh$=new D;this.internal=y(this.fallback);this.control=i(j,{self:!0});this.cdr=i(U);this.transformer=i(c,X)??z;this.value=s(()=>this.internal()??this.fallback);this.readOnly=m(!1);this.pseudoInvalid=m(null,{alias:"invalid"});this.touched=y(!1);this.status=y(void 0);this.disabled=s(()=>this.status()==="DISABLED");this.interactive=s(()=>!this.disabled()&&!this.readOnly());this.invalid=s(()=>this.pseudoInvalid()!==null?!!this.pseudoInvalid()&&this.interactive():this.interactive()&&this.touched()&&this.status()==="INVALID");this.mode=s(()=>this.readOnly()?"readonly":this.invalid()?"invalid":"valid");this.onTouched=h;this.onChange=h;this.control.valueAccessor=this,this.refresh$.pipe(f(0),g(null),k(()=>this.control.control),E(Boolean),L(),v(t=>w(t.valueChanges,t.statusChanges,t.events||N).pipe(g(null))),$()).subscribe(()=>this.update())}registerOnChange(t){this.refresh$.next(),this.onChange=e=>{let l=M(()=>this.internal());e!==l&&(t(this.transformer.toControlValue(e)),this.internal.set(e),this.update())}}registerOnTouched(t){this.onTouched=()=>{t(),this.update()}}setDisabledState(){this.update()}writeValue(t){let e=this.control instanceof Y?this.control.model:t;this.internal.set(this.transformer.fromControlValue(e)),this.update()}update(){var t,e;this.status.set((t=this.control.control)==null?void 0:t.status),this.touched.set(!!((e=this.control.control)!=null&&e.touched)),this.cdr.markForCheck()}};p.\u0275fac=function(e){return new(e||p)},p.\u0275dir=r({type:p,inputs:{readOnly:[1,"readOnly"],pseudoInvalid:[1,"invalid","pseudoInvalid"]}});var F=p;function Et(a){return u(F,a)}export{Q as a,Z as b,_ as c,c as d,ut as e,q as f,z as g,F as h,Et as i,J as j};
