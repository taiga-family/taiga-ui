import{Fd as at,Ma as _,Pa as A,h as W,hb as tt,i as z,id as nt,j as K,kb as et,n as q,nb as rt,ob as it,pb as ot,w as T,wa as m}from"./chunk-STJ74DE6.js";import{d as I,e as J,g as Q,m as X}from"./chunk-HXUUARZB.js";import{Aa as r,Bc as Y,G as U,I as S,La as Z,V as g,W as O,Wb as o,Xc as d,Za as a,ab as F,d as D,f as k,i as $,j as L,ja as b,ka as x,nd as G,p as M,pa as j,s as R,sd as H,td as p,ua as B,w as c}from"./chunk-X7N7YQIF.js";var l=class l extends k{constructor(){super(e=>this.obscured$.subscribe(e));this.el=A();this.obscured$=r(q).pipe(j(100,ot()),c(()=>_(this.el)),b(null),O(),it())}};l.\u0275fac=function(i){return new(i||l)},l.\u0275prov=B({token:l,factory:l.\u0275fac});var V=l;var f=class f{constructor(){this.activeZone=r(at,{optional:!0});this.obscured$=r(V,{self:!0}).pipe(c(t=>!!(t!=null&&t.every(e=>{var i;return ht(e)||!((i=this.activeZone)!=null&&i.contains(e))}))));this.tuiObscuredEnabled=a();this.tuiObscured$=K(this.tuiObscuredEnabled).pipe(tt(()=>this.obscured$));this.tuiObscured=z(this.tuiObscured$)}};f.\u0275fac=function(e){return new(e||f)},f.\u0275dir=o({type:f,selectors:[["","tuiObscured",""]],inputs:{tuiObscuredEnabled:[1,"tuiObscuredEnabled"]},outputs:{tuiObscured:"tuiObscured"},features:[d([V])]});var lt=f;function ht(n){return!!n.closest("tui-dialogs")&&!!n.ownerDocument.documentElement.getElementsByTagName("tui-dropdown").length}var s=class s{constructor(){this.onChange=T;this.validate=J.nullValidator}registerOnValidatorChange(t){this.onChange=t}ngOnChanges(){this.onChange()}};s.\u0275fac=function(e){return new(e||s)},s.\u0275dir=o({type:s,selectors:[["","tuiValidator",""]],inputs:{validate:[0,"tuiValidator","validate"]},features:[d([m(I,s,!0)]),Z]});var st=s;var h=class h{};h.\u0275fac=function(e){return new(e||h)},h.\u0275dir=o({type:h,selectors:[["","tuiItem",""]]});var ut=h;var v=class{};function jt(n){return{provide:v,useFactory:()=>r(n).valueTransformer}}var ct=class extends v{fromControlValue(t){return this.prevValue=t,t}toControlValue(t){return this.prevValue=t??this.prevValue,this.prevValue}},dt={fromControlValue:D,toControlValue:D};var pt=class{constructor(t,e={}){this.message=t;this.context=e}};var u=class u{constructor(){this.el=A();this.control$=new L(null);this.sub=this.control$.pipe(x(t=>(t==null?void 0:t.events)||R(null)),g(0),rt(),et()).subscribe(()=>this.handleValidation());this.tuiNativeValidator=a("Invalid")}validate(t){return this.control$.next(t),null}handleValidation(){var e,i,E,w,P;let t=!!((e=this.control$.value)!=null&&e.touched)&&((i=this.control$.value)==null?void 0:i.invalid);(E=this.el.closest("tui-textfield"))==null||E.classList.toggle("tui-invalid",t),(P=(w=this.el).setCustomValidity)==null||P.call(w,t?this.tuiNativeValidator():"")}};u.\u0275fac=function(e){return new(e||u)},u.\u0275dir=o({type:u,selectors:[["","tuiNativeValidator",""]],hostBindings:function(e,i){e&1&&Y("focusout",function(){return i.handleValidation()})},inputs:{tuiNativeValidator:[1,"tuiNativeValidator"]},features:[d([m(I,u,!0)])]});var mt=u;var ft={self:!0,optional:!0},y=class y{constructor(){this.fallback=r(nt,ft);this.refresh$=new $;this.internal=F(this.fallback);this.control=r(Q,{self:!0});this.cdr=r(G);this.transformer=r(v,ft)??dt;this.value=p(()=>this.internal()??this.fallback);this.readOnly=a(!1);this.pseudoInvalid=a(null,{alias:"invalid"});this.touched=F(!1);this.status=F(void 0);this.disabled=p(()=>this.status()==="DISABLED");this.interactive=p(()=>!this.disabled()&&!this.readOnly());this.invalid=p(()=>this.pseudoInvalid()!==null?!!this.pseudoInvalid()&&this.interactive():this.interactive()&&this.touched()&&this.status()==="INVALID");this.mode=p(()=>this.readOnly()?"readonly":this.invalid()?"invalid":"valid");this.onTouched=T;this.onChange=T;this.control.valueAccessor=this,this.refresh$.pipe(g(0),b(null),c(()=>this.control.control),S(Boolean),O(),x(t=>U(t.valueChanges,t.statusChanges,t.events||M).pipe(b(null))),W()).subscribe(()=>this.update())}registerOnChange(t){this.refresh$.next(),this.onChange=e=>{let i=H(()=>this.internal());e!==i&&(t(this.transformer.toControlValue(e)),this.internal.set(e),this.update())}}registerOnTouched(t){this.onTouched=()=>{t(),this.update()}}setDisabledState(){this.update()}writeValue(t){let e=this.control instanceof X?this.control.model:t;this.internal.set(this.transformer.fromControlValue(e)),this.update()}update(){var t,e;this.status.set((t=this.control.control)==null?void 0:t.status),this.touched.set(!!((e=this.control.control)!=null&&e.touched)),this.cdr.markForCheck()}};y.\u0275fac=function(e){return new(e||y)},y.\u0275dir=o({type:y,inputs:{readOnly:[1,"readOnly"],pseudoInvalid:[1,"invalid","pseudoInvalid"]}});var N=y;function pe(n){return m(N,n)}export{lt as a,st as b,mt as c,ut as d,v as e,jt as f,ct as g,dt as h,N as i,pe as j,pt as k};
