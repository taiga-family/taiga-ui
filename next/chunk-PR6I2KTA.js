import{g as pe,k as ce}from"./chunk-FDU6FCOW.js";import{a as de,k as me}from"./chunk-G7AMDM5V.js";import{G as oe,O as le,Q as ue}from"./chunk-TIQE7FC4.js";import{a as se}from"./chunk-OYH2WJ3O.js";import{Kb as ie,Lb as ne,Na as te,cc as ae,dc as m,fc as s,gc as g,gd as re,h as Q,ha as O,hc as M,qa as $,ta as ee,y as Z}from"./chunk-XZ2DFK5E.js";import{Aa as p,Bc as D,Cb as F,Cc as l,Db as y,La as E,Ma as c,Na as h,Nc as K,Pc as X,Rc as A,Sc as H,Tc as S,Ub as U,Va as w,Xc as q,_b as V,ad as C,cd as G,dd as u,fc as j,gc as b,gd as I,hc as k,ic as P,id as _,lc as v,nc as N,nd as J,oc as W,pc as z,qc as T,rc as f,sc as Y,wc as x}from"./chunk-X7N7YQIF.js";import{h as B}from"./chunk-42JZD6NG.js";var he=(n,t,e)=>i=>{if(!t||t instanceof s||!e)return n(i);let r=Object.fromEntries(Object.entries(e).map(([R,fe])=>[R,-fe])),a=t.append(r).append({day:1}),o=t.append(e).append({day:-1});return a.dayBefore(i)&&o.dayAfter(i)||n(i)};var _e=(n,t,e,i)=>{if(t instanceof s&&!t.isSingleDay||!t||!e)return i?n||g:n||M;let r=Object.fromEntries(Object.entries(e).map(([L,R])=>[L,-R])),o=(t instanceof m?t:t.from).append(i?r:e).append({day:i?1:-1});return i?o.dayBefore(n||g)?n||g:o:n&&o.dayAfter(n)?n:o};var ye=(n,t,e,i)=>[n,t,e,i,!1],Te=(n,t,e,i)=>[n,t,e,i,!0],De=(n,t,e,i,r,a)=>[n,t,e,i,r,a];function Ce(n,t){if(n&1){let e=x();T(0,"tui-calendar",2),u(1,"tuiMapper"),u(2,"tuiMapper"),u(3,"tuiMapper"),u(4,"tuiMapper"),S("hoveredItemChange",function(r){c(e);let a=l();return H(a.hoveredItem,r)||(a.hoveredItem=r),h(r)}),D("dayClick",function(r){c(e);let a=l();return h(a.onDayClick(r))})("monthChange",function(r){c(e);let a=l();return h(a.onMonthChange(r.append({month:-1})))}),f()}if(n&2){let e=l();b("disabledItemHandler",e.calculatedDisabledItemHandler)("markerHandler",e.markerHandler)("max",_(1,9,C(29,ye,e.max,e.capsMapper,e.currentValue,e.maxLength)))("min",_(2,15,C(34,Te,e.min,e.capsMapper,e.currentValue,e.maxLength)))("minViewedMonth",I(3,21,e.defaultViewedMonth,e.monthOffset,1))("month",I(4,25,e.defaultViewedMonth,e.monthOffset,1))("showAdjacent",!1)("value",e.currentValue),A("hoveredItem",e.hoveredItem)}}function Ve(n,t){if(n&1&&Y(0,"tui-icon",8),n&2){let e=l(4);k("font-size",1,"rem"),b("icon",e.icons.check)}}function be(n,t){if(n&1){let e=x();T(0,"button",6),D("click",function(){let r=c(e).$implicit,a=l(3);return h(a.onItemSelect(r))})("pointerdown.prevent.zoneless",function(){return c(e),h(0)}),K(1),V(2,Ve,1,3,"tui-icon",7),f()}if(n&2){let e=t.$implicit,i=l(3);j("aria-checked",i.isItemActive(e)),y(),X(" ",e," "),y(),v(i.isItemActive(e)?2:-1)}}function ve(n,t){if(n&1&&(T(0,"tui-data-list",4),W(1,be,3,3,"button",5,N),u(3,"tuiMapper"),f()),n&2){let e=l(2);k("flex",1),y(),z(_(3,2,G(9,De,e.items,e.mapper,e.min,e.max,e.minLength,e.otherDateText())))}}function Ie(n,t){if(n&1&&V(0,ve,4,16,"tui-data-list",3),n&2){let e=l();v(e.mobile?-1:0)}}var d=class d{constructor(){this.selectedPeriod=null;this.cdr=p(J);this.currentValue=null;this.previousValue=null;this.hoveredItem=null;this.month=ae.currentLocal();this.otherDateText=p(me);this.icons=p(ne);this.capsMapper=_e;this.mobile=p(re);this.disabledItemHandler=Z;this.markerHandler=null;this.items=[];this.min=g;this.max=M;this.minLength=null;this.maxLength=null;this.item=null;this.valueChange=new w;this.itemChange=new w;this.monthOffset=(t,e)=>t.append({month:e});this.mapper=(t,e,i,r,a)=>[...t.filter(o=>(r===null||o.range.from.append(r).append({day:-1}).daySameOrBefore(o.range.to))&&(e===null||o.range.to.daySameOrAfter(e))&&(i===null||o.range.from.daySameOrBefore(i))),a||""];var t;(t=p(de,{optional:!0}))==null||t.pipe(te(),Q()).subscribe(e=>{this.currentValue=e,this.initDefaultViewedMonth()})}set valueSetter(t){this.currentValue=t}set defaultViewedMonth(t){this.currentValue||(this.month=t)}set value(t){this.cdr.markForCheck(),this.currentValue=t,this.initDefaultViewedMonth()}get defaultViewedMonth(){return this.month}get selectedActivePeriod(){return this.selectedPeriod}set selectedActivePeriod(t){this.selectedPeriod=t}ngOnChanges(){this.currentValue||this.initDefaultViewedMonth()}ngOnInit(){this.initDefaultViewedMonth()}get calculatedDisabledItemHandler(){return this.calculateDisabledItemHandler(this.disabledItemHandler,this.currentValue,this.minLength)}onEsc(t){t.key!=="Escape"||!(this.currentValue instanceof m)||(t.stopPropagation(),this.currentValue=this.previousValue)}isItemActive(t){let{activePeriod:e}=this;return O(t)&&e===null||e===t||(e==null?void 0:e.toString())===t.toString()}onItemSelect(t){O(t)?this.activePeriod!==null&&(this.selectedActivePeriod=null,this.itemChange.emit(null),this.updateValue(null)):(this.selectedActivePeriod=t,this.itemChange.emit(t),this.updateValue(t.range.dayLimit(this.min,this.max))),this.initDefaultViewedMonth()}onMonthChange(t){this.month=t}onDayClick(t){if(this.previousValue=this.currentValue,this.selectedActivePeriod=null,this.currentValue instanceof m){let e=s.sort(this.currentValue,t);this.currentValue=e,this.itemChange.emit(this.findItemByDayRange(e)),this.updateValue(e)}else this.currentValue=t}updateValue(t){this.currentValue=t,this.valueChange.emit(t)}get activePeriod(){return this.item??this.selectedActivePeriod??(this.items.find(t=>$(this.currentValue instanceof m?new s(this.currentValue,this.currentValue):this.currentValue,t.range,(e,i)=>e.from.daySame(i.from.dayLimit(this.min,this.max))&&e.to.daySame(i.to.dayLimit(this.min,this.max))))||null)}calculateDisabledItemHandler(t,e,i){return he(t,e,i)}initDefaultViewedMonth(){this.currentValue instanceof m?this.month=this.currentValue:this.currentValue?this.month=this.items.length?this.currentValue.to:this.currentValue.from:this.max&&this.month.monthSameOrAfter(this.max)?this.month=this.items.length?this.max:this.max.append({month:-1}):this.min&&this.month.monthSameOrBefore(this.min)&&(this.month=this.min)}findItemByDayRange(t){return this.items.find(e=>t.daySame(e.range))??null}};d.\u0275fac=function(e){return new(e||d)},d.\u0275cmp=U({type:d,selectors:[["tui-calendar-range"]],hostVars:2,hostBindings:function(e,i){e&1&&D("keydown.capture",function(a){return i.onEsc(a)},!1,F),e&2&&P("_mobile",i.mobile)},inputs:{disabledItemHandler:"disabledItemHandler",markerHandler:"markerHandler",items:"items",min:"min",max:"max",minLength:"minLength",maxLength:"maxLength",item:"item",valueSetter:[0,"value","valueSetter"],defaultViewedMonth:"defaultViewedMonth"},outputs:{valueChange:"valueChange",itemChange:"itemChange"},features:[q([ie(d),pe({rangeMode:!0})]),E],decls:6,vars:38,consts:[["automation-id","tui-calendar-range__calendar",3,"hoveredItemChange","dayClick","monthChange","disabledItemHandler","markerHandler","max","maxViewedMonth","min","month","showAdjacent","value","hoveredItem"],[3,"disabledItemHandler","markerHandler","max","min","minViewedMonth","month","showAdjacent","value","hoveredItem"],[3,"hoveredItemChange","dayClick","monthChange","disabledItemHandler","markerHandler","max","min","minViewedMonth","month","showAdjacent","value","hoveredItem"],["automation-id","tui-calendar-range__menu","role","menu",3,"flex"],["automation-id","tui-calendar-range__menu","role","menu"],["automation-id","tui-calendar-range__menu__item","role","menuitemradio","tuiOption","","type","button"],["automation-id","tui-calendar-range__menu__item","role","menuitemradio","tuiOption","","type","button",3,"click","pointerdown.prevent.zoneless"],["automation-id","tui-calendar-range__checkmark",3,"icon","font-size"],["automation-id","tui-calendar-range__checkmark",3,"icon"]],template:function(e,i){e&1&&(T(0,"tui-calendar",0),u(1,"tuiMapper"),u(2,"tuiMapper"),u(3,"tuiMapper"),S("hoveredItemChange",function(a){return H(i.hoveredItem,a)||(i.hoveredItem=a),a}),D("dayClick",function(a){return i.onDayClick(a)})("monthChange",function(a){return i.onMonthChange(a)}),f(),V(4,Ce,5,39,"tui-calendar",1)(5,Ie,1,1)),e&2&&(P("t-calendar",!i.mobile),b("disabledItemHandler",i.calculatedDisabledItemHandler)("markerHandler",i.markerHandler)("max",_(1,12,C(28,ye,i.max,i.capsMapper,i.currentValue,i.maxLength)))("maxViewedMonth",i.items.length||i.mobile?null:I(2,18,i.defaultViewedMonth,i.monthOffset,-1))("min",_(3,22,C(33,Te,i.min,i.capsMapper,i.currentValue,i.maxLength)))("month",i.defaultViewedMonth)("showAdjacent",!!i.items.length||i.mobile)("value",i.currentValue),A("hoveredItem",i.hoveredItem),y(4),v(!i.items.length&&!i.mobile?4:5))},dependencies:[ce,ue,le,oe,se],styles:["[_nghost-%COMP%]:not(._mobile){display:flex;min-inline-size:30rem}.t-calendar[_ngcontent-%COMP%]{border-inline-end:1px solid var(--tui-border-normal)}"],changeDetection:0}),B([ee],d.prototype,"calculateDisabledItemHandler",1);var ge=d;export{he as a,_e as b,ge as c};
