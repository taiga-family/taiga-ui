import{Ea as w,R as D,V as s,ia as M,ya as k}from"./chunk-IB3FWLLF.js";import{a as N,f as H,g as L,m as _}from"./chunk-KWZHGPWS.js";import{$a as g,F as a,Gb as x,K as v,S as b,Ta as O,Vb as R,Wa as I,Wc as U,_a as S,ha as A,oa as E,wa as F,x as T,za as c}from"./chunk-2UPKG2B4.js";var n=class{constructor(p,e){this.el=p;this.options=e}get element(){return this.el.nativeElement.querySelector(this.options.query)??this.el.nativeElement}get isTextFieldElement(){return this.element.matches(this.options.query)}};var W=1e3,B=".ng-animating",m=class extends n{constructor(e,t,o,r){super(e,r);this.animationFrame$=t;this.zone=o}setFocus(){this.isTextFieldElement?v(a(this.options.delay||W),this.animationFrame$.pipe(E(100,M(this.zone)),T(()=>this.element.closest(B)),A(Boolean),b(1))).subscribe(()=>this.element.focus({preventScroll:this.options.preventScroll})):this.element.focus({preventScroll:!0})}};var Z=["type","inputMode","autocomplete","accept","min","max","step","pattern","size","maxlength"],d=class extends n{constructor(e,t,o,r,i){super(e,i);this.renderer=t;this.zone=o;this.win=r}setFocus(){this.isTextFieldElement?this.zone.runOutsideAngular(()=>this.iosWebkitAutofocus()):this.element.focus({preventScroll:!0})}iosWebkitAutofocus(){let e=this.makeFakeInput(),t=this.getDurationTimeBeforeFocus(),o=0,r=0,i=()=>e.focus({preventScroll:!0}),h=()=>{clearTimeout(o),o=this.win.setTimeout(()=>{clearTimeout(r),e.removeEventListener("blur",i),e.removeEventListener("focus",h),r=this.win.setTimeout(()=>{this.element.focus({preventScroll:this.options.preventScroll}),e.remove()},t)})};e.addEventListener("blur",i,{once:!0}),e.addEventListener("focus",h),this.insideDialog()?this.win.document.body.appendChild(e):this.element.parentElement?.appendChild(e),e.focus({preventScroll:!0})}makeFakeInput(){let e=this.renderer.createElement("input"),t=this.element.getBoundingClientRect();return this.patchFakeInputFromFocusableElement(e),e.style.height=s(t.height),e.style.width=s(t.width/2),e.style.position="fixed",e.style.zIndex="-99999999",e.style.caretColor="transparent",e.style.border="none",e.style.outline="none",e.style.color="transparent",e.style.background="transparent",e.style.cursor="none",e.style.fontSize=s(16),e.style.top=s(t.top),e.style.left=s(t.left),e}getDurationTimeBeforeFocus(){return parseFloat(this.win.getComputedStyle(this.element).getPropertyValue("--tui-duration"))||0}insideDialog(){return!!this.element.closest("tui-dialog")}patchFakeInputFromFocusableElement(e){Z.forEach(t=>{let o=this.element.getAttribute(t);D(o)&&e.setAttribute(t,o)})}};var[f,re]=w({delay:NaN,query:"input, textarea, select, [contenteditable]",preventScroll:!1}),y=new F(""),C=[{provide:y,deps:[g,L,x,I,H,_,f],useFactory:(u,p,e,t,o,r,i)=>r?new d(u,e,t,o,i):new m(u,p,t,i)}];var l=class l{constructor(){this.handler=c(y);this.options=c(f);this.destroyRef=c(O);this.autoFocus=S(void 0,{alias:"tuiAutoFocus",transform:k})}ngAfterViewInit(){this.autoFocus()&&this.focus()}focus(){Number.isNaN(this.options.delay)?Promise.resolve().then(()=>this.handler.setFocus()):a(this.options.delay).pipe(N(this.destroyRef)).subscribe(()=>this.handler.setFocus())}};l.\u0275fac=function(e){return new(e||l)},l.\u0275dir=R({type:l,selectors:[["","tuiAutoFocus",""]],inputs:{autoFocus:[1,"tuiAutoFocus","autoFocus"]},features:[U(C)]});var P=l;export{re as a,P as b};
