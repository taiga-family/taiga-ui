{"version":3,"file":"experimental.js","sourceRoot":"","sources":["../src/experimental.ts"],"names":[],"mappings":"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","sourcesContent":["// Experimental API below\n\n/**\n * get input values\n *\n * Extended by: Gabriel Schuster <github.com@actra.de>\n * Now gets values of inputs (including \"checked\" status radios, checkboxes), textareas and selects (including multiselects)\n * Tries to identify the elements as exact as possible, falls back to numeric index when identification fails\n * WIP refactor by: PatrickJS\n */\nexport function __getInputValues() {\n  const _inputs = document.querySelectorAll('input, textarea, select');\n  const inputs = Array.prototype.slice.call(_inputs);\n\n  return inputs.map(function(input: any) {\n    const inputTagName = input.tagName.toLowerCase();\n    const inputType = input.type;\n    const inputId = (input.id && typeof input.id === 'string') ? input.id : null;\n    const inputName = (input.name && typeof input.name === 'string') ? input.name : null;\n    const inputValue = (input.value && typeof input.value === 'string') ? input.value : null;\n    const inputChildNodes = input.childNodes;\n    const inputSelected = Boolean(input.selected);\n\n    type InputOption = {value: string, selected: boolean};\n    type HmrStore = {\n      tag: string;\n      type: string;\n      id: string;\n      name: string;\n      value: string;\n      checked: boolean;\n      options: Array<InputOption>;\n    };\n\n    let elementStore: HmrStore = {\n      'tag': inputTagName,\n      'type': null,\n      'id': inputId,\n      'name': inputName,\n      'value': '',\n      'checked': false,\n      'options': []\n    };\n\n    if ('input' === inputTagName || 'textarea' === inputTagName) {\n      elementStore['type'] = inputType;\n\n      if ('input' !== inputTagName) {\n        elementStore['value'] = inputValue;\n        return elementStore;\n      }\n      switch (inputType) {\n        case 'checkbox':\n        case 'radio':\n          elementStore['checked'] = inputSelected;\n          elementStore['value'] = inputValue;\n          return elementStore;\n        case 'image':\n        case 'button':\n        case 'submit':\n        case 'reset':\n        default:\n          // These types don't need any config and thus need no update, they only were stored because they match \"input\"\n          return elementStore;\n      }\n    } else if ('select' === inputTagName) {\n      const childNodes = Array.prototype.slice.call(inputChildNodes);\n\n      const options: Array<InputOption> = childNodes.map((option: any, i: number) => {\n        return { value: option['value'], selected: Boolean(option['selected']) };\n      });\n\n      elementStore['options'] = options;\n      return elementStore;\n    }\n\n    return elementStore;\n  });\n}\n\n/**\n * set input values\n *\n * Extended by: Gabriel Schuster <github.com@actra.de>\n * WIP refactor by: PatrickJS\n */\nexport function __setInputValues($inputs: any) {\n  const inputs: any = document.querySelectorAll('input, textarea');\n\n  $inputs.forEach((store: any, i: number) => {\n\n    if ('input' === store.tag || 'textarea' === store.tag) {\n      if ('input' === store.tag && ('checkbox' === store.type || 'radio' === store.type)) {\n        let selector = 'input' + (\n          null !== store.id ? '#' + store.id : ''\n        ) + '[type=\"' + store.type + '\"]' + (null !== store.name ? '[name=\"' + store.name + '\"]' : '') +\n                       '[value=\"' + store.value + '\"]';\n        let element: any  = document.body.querySelector(selector);\n\n        if (element && Boolean(store['checked'])) {\n          element['checked'] = 'checked';\n\n          element.dispatchEvent(new CustomEvent('input', {detail: element['checked']}));\n        }\n      } else if ('input' === store.tagName.toLowerCase() &&\n        ('image' === store.type || 'button' === store.type || 'submit' === store.type || 'reset' === store.type)) {\n          // These types don't need any config and thus need no update, they only were stored because they match \"input\"\n      } else {\n        if (null === store.id && null === store.name) {\n          if (store.value.length &&\n            inputs[i] &&\n            inputs[i].tagName.toLowerCase() === store.tag &&\n            ('textarea' === store.tag || inputs[i].getAttribute('type') === store.type) &&\n            ('string' !== typeof inputs[i].id || !inputs[i].id.length) &&\n            ('string' !== typeof inputs[i].getAttribute('name') ||\n            !inputs[i].getAttribute('name').length)) {\n\n              inputs[i]['value'] = store.value;\n              inputs[i].dispatchEvent(new CustomEvent('input', {detail: inputs[i]['value']}));\n          }\n        } else {\n          let selector = 'input' +\n            (null !== store.id ? '#' + store.id : '') + ('input' === store.tag ? '[type=\"' + store.type + '\"]' : '') +\n            (null !== store.name ? '[name=\"' + store.name + '\"]' : '');\n          let element: any  = document.body.querySelector(selector);\n\n          if (element && store.value.length) {\n            element['value'] = store.value;\n            element.dispatchEvent(new CustomEvent('input', {detail: element['value']}));\n          }\n        }\n      }\n  } else if ('select' === store.tag) {\n      let select: any = null;\n\n      if (null === store.id && null === store.name) {\n        if (inputs[i] && inputs[i].tagName.toLowerCase() === store.tag && ('string' !== typeof inputs[i].id || !inputs[i].id.length) &&\n           ('string' !== typeof inputs[i].getAttribute('name') || !inputs[i].getAttribute('name').length)) {\n            select = inputs[i];\n        }\n      } else {\n        let selector = 'select' + (null !== store.id ? '#' + store.id : '') + (null !== store.name ? '[name=\"' + store.name + '\"]' : '');\n        let element: any  = document.body.querySelector(selector);\n        if (element) {\n          select = element;\n        }\n      }\n\n      if (select) {\n        store.options.forEach((storedOption: any, j: number) => {\n          let option: any = select.querySelector('option[value=\"' + storedOption.value + '\"]');\n\n          if (\n            !option &&\n            select.childNodes[j] &&\n            ('string' !== typeof select.childNodes[j]['value'] || !select.childNodes[j]['value'].length)\n          ) {\n            option = select.childNodes[j];\n          }\n          if (option && !!storedOption.selected) {\n            option['selected'] = 'selected';\n\n            option.dispatchEvent(new CustomEvent('input', {detail: option['selected']}));\n          }\n        });\n      }\n    }\n  });\n}\n\nexport function __createInputTransfer() {\n  const $inputs = __getInputValues();\n  return function restoreInputValues() {\n    return __setInputValues($inputs);\n  };\n}\n"]}