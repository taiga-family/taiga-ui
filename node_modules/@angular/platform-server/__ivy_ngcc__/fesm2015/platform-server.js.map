{"version":3,"file":"platform-server.js","sources":["../../../../../../packages/platform-server/src/domino_adapter.ts","../../../../../../packages/platform-server/src/platform_state.ts","../../../../../../packages/platform-server/src/http.ts","../../../../../../packages/platform-server/src/tokens.ts","../../../../../../packages/platform-server/src/location.ts","../../../../../../packages/platform-server/src/server_events.ts","../../../../../../packages/platform-server/src/server_renderer.ts","../../../../../../packages/platform-server/src/styles_host.ts","../../../../../../packages/platform-server/src/server.ts","../../../../../../packages/platform-server/src/transfer_state.ts","../../../../../../packages/platform-server/src/utils.ts","../../../../../../packages/platform-server/src/version.ts","../../../../../../packages/platform-server/platform-server.ts"],"names":["BrowserDomAdapter","setRootDomAdapter","HttpInterceptingHandler","url.parse","getDOM","flattenStyles","SharedStylesHost","NAMESPACE_URIS","shimContentAttribute","shimHostAttribute","PLATFORM_SERVER_ID","ALLOW_MULTIPLE_PLATFORMS","NullViewportScroller","platformCoreDynamic","escapeHtml"],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nconst domino = require('domino');\n\nimport {ɵBrowserDomAdapter as BrowserDomAdapter} from '@angular/platform-browser';\nimport {ɵsetRootDomAdapter as setRootDomAdapter} from '@angular/common';\n\nfunction _notImplemented(methodName: string) {\n  return new Error('This method is not implemented in DominoAdapter: ' + methodName);\n}\n\nfunction setDomTypes() {\n  // Make all Domino types available as types in the global env.\n  Object.assign(global, domino.impl);\n  (global as any)['KeyboardEvent'] = domino.impl.Event;\n}\n\n/**\n * Parses a document string to a Document object.\n */\nexport function parseDocument(html: string, url = '/') {\n  let window = domino.createWindow(html, url);\n  let doc = window.document;\n  return doc;\n}\n\n/**\n * Serializes a document to string.\n */\nexport function serializeDocument(doc: Document): string {\n  return (doc as any).serialize();\n}\n\n/**\n * DOM Adapter for the server platform based on https://github.com/fgnass/domino.\n */\nexport class DominoAdapter extends BrowserDomAdapter {\n  static makeCurrent() {\n    setDomTypes();\n    setRootDomAdapter(new DominoAdapter());\n  }\n\n  private static defaultDoc: Document;\n\n  log(error: string) {\n    // tslint:disable-next-line:no-console\n    console.log(error);\n  }\n\n  logGroup(error: string) {\n    console.error(error);\n  }\n\n  logGroupEnd() {}\n\n  supportsDOMEvents(): boolean {\n    return false;\n  }\n\n  createHtmlDocument(): HTMLDocument {\n    return parseDocument('<html><head><title>fakeTitle</title></head><body></body></html>');\n  }\n\n  getDefaultDocument(): Document {\n    if (!DominoAdapter.defaultDoc) {\n      DominoAdapter.defaultDoc = domino.createDocument();\n    }\n    return DominoAdapter.defaultDoc;\n  }\n\n  isElementNode(node: any): boolean {\n    return node ? node.nodeType === DominoAdapter.defaultDoc.ELEMENT_NODE : false;\n  }\n  isShadowRoot(node: any): boolean {\n    return node.shadowRoot == node;\n  }\n\n  getProperty(el: Element, name: string): any {\n    if (name === 'href') {\n      // Domino tries to resolve href-s which we do not want. Just return the\n      // attribute value.\n      return el.getAttribute('href');\n    } else if (name === 'innerText') {\n      // Domino does not support innerText. Just map it to textContent.\n      return el.textContent;\n    }\n    return (<any>el)[name];\n  }\n\n  getGlobalEventTarget(doc: Document, target: string): EventTarget|null {\n    if (target === 'window') {\n      return doc.defaultView;\n    }\n    if (target === 'document') {\n      return doc;\n    }\n    if (target === 'body') {\n      return doc.body;\n    }\n    return null;\n  }\n\n  getBaseHref(doc: Document): string {\n    const base = doc.documentElement!.querySelector('base');\n    let href = '';\n    if (base) {\n      href = base.getAttribute('href')!;\n    }\n    // TODO(alxhub): Need relative path logic from BrowserDomAdapter here?\n    return href;\n  }\n\n  dispatchEvent(el: Node, evt: any) {\n    el.dispatchEvent(evt);\n\n    // Dispatch the event to the window also.\n    const doc = el.ownerDocument || el;\n    const win = (doc as any).defaultView;\n    if (win) {\n      win.dispatchEvent(evt);\n    }\n  }\n\n  getHistory(): History {\n    throw _notImplemented('getHistory');\n  }\n  getLocation(): Location {\n    throw _notImplemented('getLocation');\n  }\n  getUserAgent(): string {\n    return 'Fake user agent';\n  }\n\n  performanceNow(): number {\n    return Date.now();\n  }\n\n  supportsCookies(): boolean {\n    return false;\n  }\n  getCookie(name: string): string {\n    throw _notImplemented('getCookie');\n  }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DOCUMENT} from '@angular/common';\nimport {Inject, Injectable} from '@angular/core';\n\nimport {serializeDocument} from './domino_adapter';\n\n/**\n * Representation of the current platform state.\n *\n * @publicApi\n */\n@Injectable()\nexport class PlatformState {\n  constructor(@Inject(DOCUMENT) private _doc: any) {}\n\n  /**\n   * Renders the current state of the platform to string.\n   */\n  renderToString(): string {\n    return serializeDocument(this._doc);\n  }\n\n  /**\n   * Returns the current DOM state.\n   */\n  getDocument(): any {\n    return this._doc;\n  }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n\nconst xhr2: any = require('xhr2');\n\nimport {Injectable, Injector, Provider} from '@angular/core';\n\nimport {HttpEvent, HttpRequest, HttpHandler, HttpBackend, XhrFactory, ɵHttpInterceptingHandler as HttpInterceptingHandler} from '@angular/common/http';\n\nimport {Observable, Observer, Subscription} from 'rxjs';\n\n@Injectable()\nexport class ServerXhr implements XhrFactory {\n  build(): XMLHttpRequest {\n    return new xhr2.XMLHttpRequest();\n  }\n}\n\nexport abstract class ZoneMacroTaskWrapper<S, R> {\n  wrap(request: S): Observable<R> {\n    return new Observable((observer: Observer<R>) => {\n      let task: Task = null!;\n      let scheduled: boolean = false;\n      let sub: Subscription|null = null;\n      let savedResult: any = null;\n      let savedError: any = null;\n\n      const scheduleTask = (_task: Task) => {\n        task = _task;\n        scheduled = true;\n\n        const delegate = this.delegate(request);\n        sub = delegate.subscribe(\n            res => savedResult = res,\n            err => {\n              if (!scheduled) {\n                throw new Error(\n                    'An http observable was completed twice. This shouldn\\'t happen, please file a bug.');\n              }\n              savedError = err;\n              scheduled = false;\n              task.invoke();\n            },\n            () => {\n              if (!scheduled) {\n                throw new Error(\n                    'An http observable was completed twice. This shouldn\\'t happen, please file a bug.');\n              }\n              scheduled = false;\n              task.invoke();\n            });\n      };\n\n      const cancelTask = (_task: Task) => {\n        if (!scheduled) {\n          return;\n        }\n        scheduled = false;\n        if (sub) {\n          sub.unsubscribe();\n          sub = null;\n        }\n      };\n\n      const onComplete = () => {\n        if (savedError !== null) {\n          observer.error(savedError);\n        } else {\n          observer.next(savedResult);\n          observer.complete();\n        }\n      };\n\n      // MockBackend for Http is synchronous, which means that if scheduleTask is by\n      // scheduleMacroTask, the request will hit MockBackend and the response will be\n      // sent, causing task.invoke() to be called.\n      const _task = Zone.current.scheduleMacroTask(\n          'ZoneMacroTaskWrapper.subscribe', onComplete, {}, () => null, cancelTask);\n      scheduleTask(_task);\n\n      return () => {\n        if (scheduled && task) {\n          task.zone.cancelTask(task);\n          scheduled = false;\n        }\n        if (sub) {\n          sub.unsubscribe();\n          sub = null;\n        }\n      };\n    });\n  }\n\n  protected abstract delegate(request: S): Observable<R>;\n}\n\nexport class ZoneClientBackend extends\n    ZoneMacroTaskWrapper<HttpRequest<any>, HttpEvent<any>> implements HttpBackend {\n  constructor(private backend: HttpBackend) {\n    super();\n  }\n\n  handle(request: HttpRequest<any>): Observable<HttpEvent<any>> {\n    return this.wrap(request);\n  }\n\n  protected delegate(request: HttpRequest<any>): Observable<HttpEvent<any>> {\n    return this.backend.handle(request);\n  }\n}\n\nexport function zoneWrappedInterceptingHandler(backend: HttpBackend, injector: Injector) {\n  const realBackend: HttpBackend = new HttpInterceptingHandler(backend, injector);\n  return new ZoneClientBackend(realBackend);\n}\n\nexport const SERVER_HTTP_PROVIDERS: Provider[] = [\n  {provide: XhrFactory, useClass: ServerXhr},\n  {provide: HttpHandler, useFactory: zoneWrappedInterceptingHandler, deps: [HttpBackend, Injector]}\n];\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {InjectionToken} from '@angular/core';\n\n/**\n * Config object passed to initialize the platform.\n *\n * @publicApi\n */\nexport interface PlatformConfig {\n  document?: string;\n  url?: string;\n}\n\n/**\n * The DI token for setting the initial config for the platform.\n *\n * @publicApi\n */\nexport const INITIAL_CONFIG = new InjectionToken<PlatformConfig>('Server.INITIAL_CONFIG');\n\n/**\n * A function that will be executed when calling `renderModuleFactory` or `renderModule` just\n * before current platform state is rendered to string.\n *\n * @publicApi\n */\nexport const BEFORE_APP_SERIALIZED =\n    new InjectionToken<Array<() => void | Promise<void>>>('Server.RENDER_MODULE_HOOK');\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DOCUMENT, LocationChangeEvent, LocationChangeListener, PlatformLocation, ɵgetDOM as getDOM} from '@angular/common';\nimport {Inject, Injectable, Optional} from '@angular/core';\nimport {Subject} from 'rxjs';\nimport * as url from 'url';\nimport {INITIAL_CONFIG, PlatformConfig} from './tokens';\n\n\nfunction parseUrl(urlStr: string) {\n  const parsedUrl = url.parse(urlStr);\n  return {\n    hostname: parsedUrl.hostname || '',\n    protocol: parsedUrl.protocol || '',\n    port: parsedUrl.port || '',\n    pathname: parsedUrl.pathname || '',\n    search: parsedUrl.search || '',\n    hash: parsedUrl.hash || '',\n  };\n}\n\n/**\n * Server-side implementation of URL state. Implements `pathname`, `search`, and `hash`\n * but not the state stack.\n */\n@Injectable()\nexport class ServerPlatformLocation implements PlatformLocation {\n  public readonly href: string = '/';\n  public readonly hostname: string = '/';\n  public readonly protocol: string = '/';\n  public readonly port: string = '/';\n  public readonly pathname: string = '/';\n  public readonly search: string = '';\n  public readonly hash: string = '';\n  private _hashUpdate = new Subject<LocationChangeEvent>();\n\n  constructor(\n      @Inject(DOCUMENT) private _doc: any, @Optional() @Inject(INITIAL_CONFIG) _config: any) {\n    const config = _config as PlatformConfig | null;\n    if (!!config && !!config.url) {\n      const parsedUrl = parseUrl(config.url);\n      this.hostname = parsedUrl.hostname;\n      this.protocol = parsedUrl.protocol;\n      this.port = parsedUrl.port;\n      this.pathname = parsedUrl.pathname;\n      this.search = parsedUrl.search;\n      this.hash = parsedUrl.hash;\n    }\n  }\n\n  getBaseHrefFromDOM(): string {\n    return getDOM().getBaseHref(this._doc)!;\n  }\n\n  onPopState(fn: LocationChangeListener): void {\n    // No-op: a state stack is not implemented, so\n    // no events will ever come.\n  }\n\n  onHashChange(fn: LocationChangeListener): void {\n    this._hashUpdate.subscribe(fn);\n  }\n\n  get url(): string {\n    return `${this.pathname}${this.search}${this.hash}`;\n  }\n\n  private setHash(value: string, oldUrl: string) {\n    if (this.hash === value) {\n      // Don't fire events if the hash has not changed.\n      return;\n    }\n    (this as {hash: string}).hash = value;\n    const newUrl = this.url;\n    scheduleMicroTask(\n        () => this._hashUpdate.next(\n            {type: 'hashchange', state: null, oldUrl, newUrl} as LocationChangeEvent));\n  }\n\n  replaceState(state: any, title: string, newUrl: string): void {\n    const oldUrl = this.url;\n    const parsedUrl = parseUrl(newUrl);\n    (this as {pathname: string}).pathname = parsedUrl.pathname;\n    (this as {search: string}).search = parsedUrl.search;\n    this.setHash(parsedUrl.hash, oldUrl);\n  }\n\n  pushState(state: any, title: string, newUrl: string): void {\n    this.replaceState(state, title, newUrl);\n  }\n\n  forward(): void {\n    throw new Error('Not implemented');\n  }\n\n  back(): void {\n    throw new Error('Not implemented');\n  }\n\n  // History API isn't available on server, therefore return undefined\n  getState(): unknown {\n    return undefined;\n  }\n}\n\nexport function scheduleMicroTask(fn: Function) {\n  Zone.current.scheduleMicroTask('scheduleMicrotask', fn);\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DOCUMENT, ɵgetDOM as getDOM} from '@angular/common';\nimport {Inject, Injectable} from '@angular/core';\n\n@Injectable()\nexport class ServerEventManagerPlugin /* extends EventManagerPlugin which is private */ {\n  constructor(@Inject(DOCUMENT) private doc: any) {}\n\n  // Handle all events on the server.\n  supports(eventName: string) {\n    return true;\n  }\n\n  addEventListener(element: HTMLElement, eventName: string, handler: Function): Function {\n    return getDOM().onAndCancel(element, eventName, handler);\n  }\n\n  addGlobalEventListener(element: string, eventName: string, handler: Function): Function {\n    const target: HTMLElement = getDOM().getGlobalEventTarget(this.doc, element);\n    if (!target) {\n      throw new Error(`Unsupported event target ${target} for event ${eventName}`);\n    }\n    return this.addEventListener(target, eventName, handler);\n  }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DOCUMENT, ɵgetDOM as getDOM} from '@angular/common';\nimport {DomElementSchemaRegistry} from '@angular/compiler';\nimport {Inject, Injectable, NgZone, Renderer2, RendererFactory2, RendererStyleFlags2, RendererType2, ViewEncapsulation} from '@angular/core';\nimport {EventManager, ɵflattenStyles as flattenStyles, ɵNAMESPACE_URIS as NAMESPACE_URIS, ɵSharedStylesHost as SharedStylesHost, ɵshimContentAttribute as shimContentAttribute, ɵshimHostAttribute as shimHostAttribute} from '@angular/platform-browser';\n\nconst EMPTY_ARRAY: any[] = [];\n\nconst DEFAULT_SCHEMA = new DomElementSchemaRegistry();\n\n@Injectable()\nexport class ServerRendererFactory2 implements RendererFactory2 {\n  private rendererByCompId = new Map<string, Renderer2>();\n  private defaultRenderer: Renderer2;\n  private schema = DEFAULT_SCHEMA;\n\n  constructor(\n      private eventManager: EventManager, private ngZone: NgZone,\n      @Inject(DOCUMENT) private document: any, private sharedStylesHost: SharedStylesHost) {\n    this.defaultRenderer = new DefaultServerRenderer2(eventManager, document, ngZone, this.schema);\n  }\n\n  createRenderer(element: any, type: RendererType2|null): Renderer2 {\n    if (!element || !type) {\n      return this.defaultRenderer;\n    }\n    switch (type.encapsulation) {\n      case ViewEncapsulation.Native:\n      case ViewEncapsulation.Emulated: {\n        let renderer = this.rendererByCompId.get(type.id);\n        if (!renderer) {\n          renderer = new EmulatedEncapsulationServerRenderer2(\n              this.eventManager, this.document, this.ngZone, this.sharedStylesHost, this.schema,\n              type);\n          this.rendererByCompId.set(type.id, renderer);\n        }\n        (<EmulatedEncapsulationServerRenderer2>renderer).applyToHost(element);\n        return renderer;\n      }\n      default: {\n        if (!this.rendererByCompId.has(type.id)) {\n          const styles = flattenStyles(type.id, type.styles, []);\n          this.sharedStylesHost.addStyles(styles);\n          this.rendererByCompId.set(type.id, this.defaultRenderer);\n        }\n        return this.defaultRenderer;\n      }\n    }\n  }\n\n  begin() {}\n  end() {}\n}\n\nclass DefaultServerRenderer2 implements Renderer2 {\n  data: {[key: string]: any} = Object.create(null);\n\n  constructor(\n      private eventManager: EventManager, protected document: any, private ngZone: NgZone,\n      private schema: DomElementSchemaRegistry) {}\n\n  destroy(): void {}\n\n  destroyNode: null;\n\n  createElement(name: string, namespace?: string, debugInfo?: any): any {\n    if (namespace) {\n      const doc = this.document || getDOM().getDefaultDocument();\n      // TODO(FW-811): Ivy may cause issues here because it's passing around\n      // full URIs for namespaces, therefore this lookup will fail.\n      return doc.createElementNS(NAMESPACE_URIS[namespace], name);\n    }\n\n    return getDOM().createElement(name, this.document);\n  }\n\n  createComment(value: string, debugInfo?: any): any {\n    return getDOM().getDefaultDocument().createComment(value);\n  }\n\n  createText(value: string, debugInfo?: any): any {\n    const doc = getDOM().getDefaultDocument();\n    return doc.createTextNode(value);\n  }\n\n  appendChild(parent: any, newChild: any): void {\n    parent.appendChild(newChild);\n  }\n\n  insertBefore(parent: any, newChild: any, refChild: any): void {\n    if (parent) {\n      parent.insertBefore(newChild, refChild);\n    }\n  }\n\n  removeChild(parent: any, oldChild: any): void {\n    if (parent) {\n      parent.removeChild(oldChild);\n    }\n  }\n\n  selectRootElement(selectorOrNode: string|any, debugInfo?: any): any {\n    let el: any;\n    if (typeof selectorOrNode === 'string') {\n      el = this.document.querySelector(selectorOrNode);\n      if (!el) {\n        throw new Error(`The selector \"${selectorOrNode}\" did not match any elements`);\n      }\n    } else {\n      el = selectorOrNode;\n    }\n    while (el.firstChild) {\n      el.removeChild(el.firstChild);\n    }\n    return el;\n  }\n\n  parentNode(node: any): any {\n    return node.parentNode;\n  }\n\n  nextSibling(node: any): any {\n    return node.nextSibling;\n  }\n\n  setAttribute(el: any, name: string, value: string, namespace?: string): void {\n    if (namespace) {\n      // TODO(FW-811): Ivy may cause issues here because it's passing around\n      // full URIs for namespaces, therefore this lookup will fail.\n      el.setAttributeNS(NAMESPACE_URIS[namespace], namespace + ':' + name, value);\n    } else {\n      el.setAttribute(name, value);\n    }\n  }\n\n  removeAttribute(el: any, name: string, namespace?: string): void {\n    if (namespace) {\n      // TODO(FW-811): Ivy may cause issues here because it's passing around\n      // full URIs for namespaces, therefore this lookup will fail.\n      el.removeAttributeNS(NAMESPACE_URIS[namespace], name);\n    } else {\n      el.removeAttribute(name);\n    }\n  }\n\n  addClass(el: any, name: string): void {\n    el.classList.add(name);\n  }\n\n  removeClass(el: any, name: string): void {\n    el.classList.remove(name);\n  }\n\n  setStyle(el: any, style: string, value: any, flags: RendererStyleFlags2): void {\n    style = style.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n    const styleMap = _readStyleAttribute(el);\n    styleMap[style] = value == null ? '' : value;\n    _writeStyleAttribute(el, styleMap);\n  }\n\n  removeStyle(el: any, style: string, flags: RendererStyleFlags2): void {\n    // IE requires '' instead of null\n    // see https://github.com/angular/angular/issues/7916\n    this.setStyle(el, style, '', flags);\n  }\n\n  // The value was validated already as a property binding, against the property name.\n  // To know this value is safe to use as an attribute, the security context of the\n  // attribute with the given name is checked against that security context of the\n  // property.\n  private _isSafeToReflectProperty(tagName: string, propertyName: string): boolean {\n    return this.schema.securityContext(tagName, propertyName, true) ===\n        this.schema.securityContext(tagName, propertyName, false);\n  }\n\n  setProperty(el: any, name: string, value: any): void {\n    checkNoSyntheticProp(name, 'property');\n    if (name === 'innerText') {\n      // Domino does not support innerText. Just map it to textContent.\n      el.textContent = value;\n    }\n    (<any>el)[name] = value;\n    // Mirror property values for known HTML element properties in the attributes.\n    // Skip `innerhtml` which is conservatively marked as an attribute for security\n    // purposes but is not actually an attribute.\n    const tagName = (el.tagName as string).toLowerCase();\n    if (value != null && (typeof value === 'number' || typeof value == 'string') &&\n        name.toLowerCase() !== 'innerhtml' && this.schema.hasElement(tagName, EMPTY_ARRAY) &&\n        this.schema.hasProperty(tagName, name, EMPTY_ARRAY) &&\n        this._isSafeToReflectProperty(tagName, name)) {\n      this.setAttribute(el, name, value.toString());\n    }\n  }\n\n  setValue(node: any, value: string): void {\n    node.textContent = value;\n  }\n\n  listen(\n      target: 'document'|'window'|'body'|any, eventName: string,\n      callback: (event: any) => boolean): () => void {\n    checkNoSyntheticProp(eventName, 'listener');\n    if (typeof target === 'string') {\n      return <() => void>this.eventManager.addGlobalEventListener(\n          target, eventName, this.decoratePreventDefault(callback));\n    }\n    return <() => void>this.eventManager.addEventListener(\n               target, eventName, this.decoratePreventDefault(callback)) as () => void;\n  }\n\n  private decoratePreventDefault(eventHandler: Function): Function {\n    return (event: any) => {\n      // Ivy uses `Function` as a special token that allows us to unwrap the function\n      // so that it can be invoked programmatically by `DebugNode.triggerEventHandler`.\n      if (event === Function) {\n        return eventHandler;\n      }\n\n      // Run the event handler inside the ngZone because event handlers are not patched\n      // by Zone on the server. This is required only for tests.\n      const allowDefaultBehavior = this.ngZone.runGuarded(() => eventHandler(event));\n      if (allowDefaultBehavior === false) {\n        event.preventDefault();\n        event.returnValue = false;\n      }\n\n      return undefined;\n    };\n  }\n}\n\nconst AT_CHARCODE = '@'.charCodeAt(0);\nfunction checkNoSyntheticProp(name: string, nameKind: string) {\n  if (name.charCodeAt(0) === AT_CHARCODE) {\n    throw new Error(`Found the synthetic ${nameKind} ${\n        name}. Please include either \"BrowserAnimationsModule\" or \"NoopAnimationsModule\" in your application.`);\n  }\n}\n\nclass EmulatedEncapsulationServerRenderer2 extends DefaultServerRenderer2 {\n  private contentAttr: string;\n  private hostAttr: string;\n\n  constructor(\n      eventManager: EventManager, document: any, ngZone: NgZone, sharedStylesHost: SharedStylesHost,\n      schema: DomElementSchemaRegistry, private component: RendererType2) {\n    super(eventManager, document, ngZone, schema);\n    // Add a 's' prefix to style attributes to indicate server.\n    const componentId = 's' + component.id;\n    const styles = flattenStyles(componentId, component.styles, []);\n    sharedStylesHost.addStyles(styles);\n\n    this.contentAttr = shimContentAttribute(componentId);\n    this.hostAttr = shimHostAttribute(componentId);\n  }\n\n  applyToHost(element: any) {\n    super.setAttribute(element, this.hostAttr, '');\n  }\n\n  createElement(parent: any, name: string): Element {\n    const el = super.createElement(parent, name, this.document);\n    super.setAttribute(el, this.contentAttr, '');\n    return el;\n  }\n}\n\nfunction _readStyleAttribute(element: any): {[name: string]: string} {\n  const styleMap: {[name: string]: string} = {};\n  const styleAttribute = element.getAttribute('style');\n  if (styleAttribute) {\n    const styleList = styleAttribute.split(/;+/g);\n    for (let i = 0; i < styleList.length; i++) {\n      const style = styleList[i].trim();\n      if (style.length > 0) {\n        const colonIndex = style.indexOf(':');\n        if (colonIndex === -1) {\n          throw new Error(`Invalid CSS style: ${style}`);\n        }\n        const name = style.substr(0, colonIndex).trim();\n        styleMap[name] = style.substr(colonIndex + 1).trim();\n      }\n    }\n  }\n  return styleMap;\n}\n\nfunction _writeStyleAttribute(element: any, styleMap: {[name: string]: string}) {\n  let styleAttrValue = '';\n  for (const key in styleMap) {\n    const newValue = styleMap[key];\n    if (newValue != null) {\n      styleAttrValue += key + ':' + styleMap[key] + ';';\n    }\n  }\n  element.setAttribute('style', styleAttrValue);\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DOCUMENT, ɵgetDOM as getDOM} from '@angular/common';\nimport {Inject, Injectable, Optional} from '@angular/core';\nimport {ɵSharedStylesHost as SharedStylesHost, ɵTRANSITION_ID} from '@angular/platform-browser';\n\n@Injectable()\nexport class ServerStylesHost extends SharedStylesHost {\n  private head: any = null;\n\n  constructor(\n      @Inject(DOCUMENT) private doc: any,\n      @Optional() @Inject(ɵTRANSITION_ID) private transitionId: string) {\n    super();\n    this.head = doc.getElementsByTagName('head')[0];\n  }\n\n  private _addStyle(style: string): void {\n    let adapter = getDOM();\n    const el = adapter.createElement('style');\n    el.textContent = style;\n    if (!!this.transitionId) {\n      el.setAttribute('ng-transition', this.transitionId);\n    }\n    this.head.appendChild(el);\n  }\n\n  onStylesAdded(additions: Set<string>) {\n    additions.forEach(style => this._addStyle(style));\n  }\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ɵAnimationEngine} from '@angular/animations/browser';\nimport {DOCUMENT, PlatformLocation, ViewportScroller, ɵgetDOM as getDOM, ɵNullViewportScroller as NullViewportScroller, ɵPLATFORM_SERVER_ID as PLATFORM_SERVER_ID} from '@angular/common';\nimport {HttpClientModule} from '@angular/common/http';\nimport {createPlatformFactory, Injector, NgModule, NgZone, Optional, PLATFORM_ID, PLATFORM_INITIALIZER, platformCore, PlatformRef, Provider, RendererFactory2, StaticProvider, Testability, ɵALLOW_MULTIPLE_PLATFORMS as ALLOW_MULTIPLE_PLATFORMS, ɵsetDocument} from '@angular/core';\nimport {BrowserModule, EVENT_MANAGER_PLUGINS, ɵSharedStylesHost as SharedStylesHost} from '@angular/platform-browser';\nimport {ɵplatformCoreDynamic as platformCoreDynamic} from '@angular/platform-browser-dynamic';\nimport {NoopAnimationsModule, ɵAnimationRendererFactory} from '@angular/platform-browser/animations';\n\nimport {DominoAdapter, parseDocument} from './domino_adapter';\nimport {SERVER_HTTP_PROVIDERS} from './http';\nimport {ServerPlatformLocation} from './location';\nimport {PlatformState} from './platform_state';\nimport {ServerEventManagerPlugin} from './server_events';\nimport {ServerRendererFactory2} from './server_renderer';\nimport {ServerStylesHost} from './styles_host';\nimport {INITIAL_CONFIG, PlatformConfig} from './tokens';\n\nfunction notSupported(feature: string): Error {\n  throw new Error(`platform-server does not support '${feature}'.`);\n}\n\nexport const INTERNAL_SERVER_PLATFORM_PROVIDERS: StaticProvider[] = [\n  {provide: DOCUMENT, useFactory: _document, deps: [Injector]},\n  {provide: PLATFORM_ID, useValue: PLATFORM_SERVER_ID},\n  {provide: PLATFORM_INITIALIZER, useFactory: initDominoAdapter, multi: true, deps: [Injector]}, {\n    provide: PlatformLocation,\n    useClass: ServerPlatformLocation,\n    deps: [DOCUMENT, [Optional, INITIAL_CONFIG]]\n  },\n  {provide: PlatformState, deps: [DOCUMENT]},\n  // Add special provider that allows multiple instances of platformServer* to be created.\n  {provide: ALLOW_MULTIPLE_PLATFORMS, useValue: true}\n];\n\nfunction initDominoAdapter(injector: Injector) {\n  return () => {\n    DominoAdapter.makeCurrent();\n  };\n}\n\nexport function instantiateServerRendererFactory(\n    renderer: RendererFactory2, engine: ɵAnimationEngine, zone: NgZone) {\n  return new ɵAnimationRendererFactory(renderer, engine, zone);\n}\n\nexport const SERVER_RENDER_PROVIDERS: Provider[] = [\n  ServerRendererFactory2,\n  {\n    provide: RendererFactory2,\n    useFactory: instantiateServerRendererFactory,\n    deps: [ServerRendererFactory2, ɵAnimationEngine, NgZone]\n  },\n  ServerStylesHost,\n  {provide: SharedStylesHost, useExisting: ServerStylesHost},\n  {provide: EVENT_MANAGER_PLUGINS, multi: true, useClass: ServerEventManagerPlugin},\n];\n\n/**\n * The ng module for the server.\n *\n * @publicApi\n */\n@NgModule({\n  exports: [BrowserModule],\n  imports: [HttpClientModule, NoopAnimationsModule],\n  providers: [\n    SERVER_RENDER_PROVIDERS,\n    SERVER_HTTP_PROVIDERS,\n    {provide: Testability, useValue: null},\n    {provide: ViewportScroller, useClass: NullViewportScroller},\n  ],\n})\nexport class ServerModule {\n}\n\nfunction _document(injector: Injector) {\n  let config: PlatformConfig|null = injector.get(INITIAL_CONFIG, null);\n  const document = config && config.document ? parseDocument(config.document, config.url) :\n                                               getDOM().createHtmlDocument();\n  // Tell ivy about the global document\n  ɵsetDocument(document);\n  return document;\n}\n\n/**\n * @publicApi\n */\nexport const platformServer: (extraProviders?: StaticProvider[]|undefined) => PlatformRef =\n    createPlatformFactory(platformCore, 'server', INTERNAL_SERVER_PLATFORM_PROVIDERS);\n\n/**\n * The server platform that supports the runtime compiler.\n *\n * @publicApi\n */\nexport const platformDynamicServer =\n    createPlatformFactory(platformCoreDynamic, 'serverDynamic', INTERNAL_SERVER_PLATFORM_PROVIDERS);\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {DOCUMENT} from '@angular/common';\nimport {APP_ID, NgModule} from '@angular/core';\nimport {TransferState, ɵescapeHtml as escapeHtml} from '@angular/platform-browser';\n\nimport {BEFORE_APP_SERIALIZED} from './tokens';\n\nexport function serializeTransferStateFactory(\n    doc: Document, appId: string, transferStore: TransferState) {\n  return () => {\n    const script = doc.createElement('script');\n    script.id = appId + '-state';\n    script.setAttribute('type', 'application/json');\n    script.textContent = escapeHtml(transferStore.toJson());\n    doc.body.appendChild(script);\n  };\n}\n\n/**\n * NgModule to install on the server side while using the `TransferState` to transfer state from\n * server to client.\n *\n * @publicApi\n */\n@NgModule({\n  providers: [\n    TransferState, {\n      provide: BEFORE_APP_SERIALIZED,\n      useFactory: serializeTransferStateFactory,\n      deps: [DOCUMENT, APP_ID, TransferState],\n      multi: true,\n    }\n  ]\n})\nexport class ServerTransferStateModule {\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ApplicationRef, NgModuleFactory, NgModuleRef, PlatformRef, StaticProvider, Type, ɵisPromise} from '@angular/core';\nimport {ɵTRANSITION_ID} from '@angular/platform-browser';\nimport {first} from 'rxjs/operators';\n\nimport {PlatformState} from './platform_state';\nimport {platformDynamicServer, platformServer} from './server';\nimport {BEFORE_APP_SERIALIZED, INITIAL_CONFIG} from './tokens';\n\ninterface PlatformOptions {\n  document?: string;\n  url?: string;\n  extraProviders?: StaticProvider[];\n}\n\nfunction _getPlatform(\n    platformFactory: (extraProviders: StaticProvider[]) => PlatformRef,\n    options: PlatformOptions): PlatformRef {\n  const extraProviders = options.extraProviders ? options.extraProviders : [];\n  return platformFactory([\n    {provide: INITIAL_CONFIG, useValue: {document: options.document, url: options.url}},\n    extraProviders\n  ]);\n}\n\nfunction _render<T>(\n    platform: PlatformRef, moduleRefPromise: Promise<NgModuleRef<T>>): Promise<string> {\n  return moduleRefPromise.then((moduleRef) => {\n    const transitionId = moduleRef.injector.get(ɵTRANSITION_ID, null);\n    if (!transitionId) {\n      throw new Error(\n          `renderModule[Factory]() requires the use of BrowserModule.withServerTransition() to ensure\nthe server-rendered app can be properly bootstrapped into a client app.`);\n    }\n    const applicationRef: ApplicationRef = moduleRef.injector.get(ApplicationRef);\n    return applicationRef.isStable.pipe((first((isStable: boolean) => isStable)))\n        .toPromise()\n        .then(() => {\n          const platformState = platform.injector.get(PlatformState);\n\n          const asyncPromises: Promise<any>[] = [];\n\n          // Run any BEFORE_APP_SERIALIZED callbacks just before rendering to string.\n          const callbacks = moduleRef.injector.get(BEFORE_APP_SERIALIZED, null);\n          if (callbacks) {\n            for (const callback of callbacks) {\n              try {\n                const callbackResult = callback();\n                if (ɵisPromise(callbackResult)) {\n                  // TODO: in TS3.7, callbackResult is void.\n                  asyncPromises.push(callbackResult as any);\n                }\n\n              } catch (e) {\n                // Ignore exceptions.\n                console.warn('Ignoring BEFORE_APP_SERIALIZED Exception: ', e);\n              }\n            }\n          }\n\n          const complete = () => {\n            const output = platformState.renderToString();\n            platform.destroy();\n            return output;\n          };\n\n          if (asyncPromises.length === 0) {\n            return complete();\n          }\n\n          return Promise\n              .all(asyncPromises.map(asyncPromise => {\n                return asyncPromise.catch(e => {\n                  console.warn('Ignoring BEFORE_APP_SERIALIZED Exception: ', e);\n                });\n              }))\n              .then(complete);\n        });\n  });\n}\n\n/**\n * Renders a Module to string.\n *\n * `document` is the full document HTML of the page to render, as a string.\n * `url` is the URL for the current render request.\n * `extraProviders` are the platform level providers for the current render request.\n *\n * Do not use this in a production server environment. Use pre-compiled {@link NgModuleFactory} with\n * {@link renderModuleFactory} instead.\n *\n * @publicApi\n */\nexport function renderModule<T>(\n    module: Type<T>, options: {document?: string, url?: string, extraProviders?: StaticProvider[]}):\n    Promise<string> {\n  const platform = _getPlatform(platformDynamicServer, options);\n  return _render(platform, platform.bootstrapModule(module));\n}\n\n/**\n * Renders a {@link NgModuleFactory} to string.\n *\n * `document` is the full document HTML of the page to render, as a string.\n * `url` is the URL for the current render request.\n * `extraProviders` are the platform level providers for the current render request.\n *\n * @publicApi\n */\nexport function renderModuleFactory<T>(\n    moduleFactory: NgModuleFactory<T>,\n    options: {document?: string, url?: string, extraProviders?: StaticProvider[]}):\n    Promise<string> {\n  const platform = _getPlatform(platformServer, options);\n  return _render(platform, platform.bootstrapModuleFactory(moduleFactory));\n}\n","/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\n/**\n * @module\n * @description\n * Entry point for all public APIs of the common package.\n */\n\nimport {Version} from '@angular/core';\n\n/**\n * @publicApi\n */\nexport const VERSION = new Version('9.1.12');\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {SERVER_HTTP_PROVIDERS as ɵangular_packages_platform_server_platform_server_g,ServerXhr as ɵangular_packages_platform_server_platform_server_e,zoneWrappedInterceptingHandler as ɵangular_packages_platform_server_platform_server_f} from './src/http';\nexport {instantiateServerRendererFactory as ɵangular_packages_platform_server_platform_server_a} from './src/server';\nexport {ServerEventManagerPlugin as ɵangular_packages_platform_server_platform_server_d} from './src/server_events';\nexport {ServerStylesHost as ɵangular_packages_platform_server_platform_server_c} from './src/styles_host';\nexport {serializeTransferStateFactory as ɵangular_packages_platform_server_platform_server_b} from './src/transfer_state';"]}