import{Ea as w,R as D,V as l,ia as M,ya as k}from"./chunk-GQSNNR3F.js";import{a as U,f as H,g as L,m as _}from"./chunk-U7E5I6OK.js";import{$a as S,E as a,Gb as x,J as v,S as b,Ta as O,Vb as R,Wa as I,Wc as N,_a as g,ha as A,oa as E,w as T,wa as F,za as c}from"./chunk-AXUCSVX7.js";var n=class{constructor(s,e){this.el=s;this.options=e}get element(){return(this.el.nativeElement.tagName.includes("-")?this.el.nativeElement.querySelector(this.options.query):this.el.nativeElement)||this.el.nativeElement}get isTextFieldElement(){return this.element.matches(this.options.query)}};var W=1e3,B=".ng-animating",m=class extends n{constructor(e,t,o,r){super(e,r);this.animationFrame$=t;this.zone=o}setFocus(){this.isTextFieldElement?v(a(this.options.delay||W),this.animationFrame$.pipe(E(100,M(this.zone)),T(()=>this.element.closest(B)),A(Boolean),b(1))).subscribe(()=>this.element.focus({preventScroll:this.options.preventScroll})):this.element.focus({preventScroll:!0})}};var Z=["type","inputMode","autocomplete","accept","min","max","step","pattern","size","maxlength"],d=class extends n{constructor(e,t,o,r,i){super(e,i);this.renderer=t;this.zone=o;this.win=r}setFocus(){this.isTextFieldElement?this.zone.runOutsideAngular(()=>this.iosWebkitAutofocus()):this.element.focus({preventScroll:!0})}iosWebkitAutofocus(){let e=this.makeFakeInput(),t=this.getDurationTimeBeforeFocus(),o=0,r=0,i=()=>e.focus({preventScroll:!0}),h=()=>{clearTimeout(o),o=this.win.setTimeout(()=>{clearTimeout(r),e.removeEventListener("blur",i),e.removeEventListener("focus",h),r=this.win.setTimeout(()=>{this.element.focus({preventScroll:this.options.preventScroll}),e.remove()},t)})};e.addEventListener("blur",i,{once:!0}),e.addEventListener("focus",h),this.insideDialog()?this.win.document.body.appendChild(e):this.element.parentElement?.appendChild(e),e.focus({preventScroll:!0})}makeFakeInput(){let e=this.renderer.createElement("input"),t=this.element.getBoundingClientRect();return this.patchFakeInputFromFocusableElement(e),e.style.height=l(t.height),e.style.width=l(t.width/2),e.style.position="fixed",e.style.zIndex="-99999999",e.style.caretColor="transparent",e.style.border="none",e.style.outline="none",e.style.color="transparent",e.style.background="transparent",e.style.cursor="none",e.style.fontSize=l(16),e.style.top=l(t.top),e.style.left=l(t.left),e}getDurationTimeBeforeFocus(){return parseFloat(this.win.getComputedStyle(this.element).getPropertyValue("--tui-duration"))||0}insideDialog(){return!!this.element.closest("tui-dialog")}patchFakeInputFromFocusableElement(e){Z.forEach(t=>{let o=this.element.getAttribute(t);D(o)&&e.setAttribute(t,o)})}};var[f,re]=w({delay:NaN,query:"input, textarea, select, [contenteditable]",preventScroll:!1}),y=new F(""),C=[{provide:y,deps:[S,L,x,I,H,_,f],useFactory:(p,s,e,t,o,r,i)=>r?new d(p,e,t,o,i):new m(p,s,t,i)}];var u=class u{constructor(){this.handler=c(y);this.options=c(f);this.destroyRef=c(O);this.autoFocus=g(void 0,{alias:"tuiAutoFocus",transform:k})}ngAfterViewInit(){this.autoFocus()&&this.focus()}focus(){Number.isNaN(this.options.delay)?Promise.resolve().then(()=>this.handler.setFocus()):a(this.options.delay).pipe(U(this.destroyRef)).subscribe(()=>this.handler.setFocus())}};u.\u0275fac=function(e){return new(e||u)},u.\u0275dir=R({type:u,selectors:[["","tuiAutoFocus",""]],inputs:{autoFocus:[1,"tuiAutoFocus","autoFocus"]},features:[N(C)]});var P=u;export{re as a,P as b};
